# ğŸ—ºï¸ Multi-Agent Tour Guide System

<div align="center">

![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg?style=for-the-badge&logo=python)
![UV](https://img.shields.io/badge/uv-package%20manager-blueviolet.svg?style=for-the-badge)
![MIT License](https://img.shields.io/badge/License-MIT-yellow.svg?style=for-the-badge)
![Architecture](https://img.shields.io/badge/Architecture-MIT%20Level-green.svg?style=for-the-badge)

**Enterprise-Grade Multi-Agent Orchestration System**

*Parallel AI agents â€¢ Plugin architecture â€¢ Resilience patterns â€¢ Full observability*

[Quick Start](#-quick-start) â€¢
[Architecture](#-architecture) â€¢
[Installation](#-installation) â€¢
[Usage](#-usage) â€¢
[Monitoring](#-monitoring-traffic-on-all-hops) â€¢
[Plugins](#-plugin-system)

</div>

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Quick Start](#-quick-start)
- [Architecture](#-architecture)
- [Installation](#-installation)
- [Usage](#-usage)
- [Monitoring Traffic on All Hops](#-monitoring-traffic-on-all-hops)
- [Plugin System](#-plugin-system)
- [Configuration](#-configuration)
- [Testing](#-testing)
- [API Reference](#-api-reference)
- [Documentation](#-documentation)

---

## ğŸ¯ Overview

A **production-grade multi-agent AI system** that creates personalized tour guides. Given a route, the system uses **parallel AI agents** to find the most relevant content (video, music, text) for each point, with a **Judge agent** selecting the best based on **user profile**.

### âœ¨ Key Features

| Feature | Description |
|---------|-------------|
| ğŸ¤– **Parallel Agents** | Video, Music, Text agents work simultaneously using ThreadPoolExecutor |
| ğŸ“¬ **Smart Queue** | Wait for 3 agents, accept 2 after 15s, accept 1 after 30s |
| ğŸ‘¤ **User Profiles** | Content personalized by age, gender, interests |
| ğŸ”Œ **Plugin Architecture** | Add new agents without modifying core code |
| âš¡ **Resilience Patterns** | Circuit breaker, retry, timeout, rate limiting |
| ğŸ“Š **Full Observability** | Metrics, distributed tracing, health checks |
| ğŸ’‰ **Dependency Injection** | Loose coupling, testability, extensibility |
| ğŸ£ **Hook System** | AOP-style before/after/around hooks |

---

## ğŸš€ Quick Start

```bash
# 1. Install UV (ultra-fast Python package manager)
curl -LsSf https://astral.sh/uv/install.sh | sh

# 2. Clone and setup
git clone <your-repo-url>
cd Assignment4-multi-agent-tour-guide-parallel
make setup

# 3. Run demo with full traffic visibility
make run-demo

# 4. Run with queue mode (recommended - shows all hops)
make run-queue
```

### 30-Second Demo

```bash
# See agents racing and queue synchronization
uv run python main.py --demo --mode queue

# Expected output:
# ğŸ“¬ Queue-based processing: Tel Aviv â†’ Jerusalem
# ğŸ“ [1/4] Ammunition Hill
#    âœ… Video Agent submitted (1/3)
#    âœ… Music Agent submitted (2/3)
#    âœ… Text Agent submitted (3/3)
#    â³ Queue ready! Judge evaluating...
#    ğŸ† Winner: VIDEO - "Battle of Ammunition Hill"
```

---

## ğŸ—ï¸ Architecture

### High-Level System Overview

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         MULTI-AGENT TOUR GUIDE SYSTEM                        â•‘
â•‘                        MIT-Level Production Architecture                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                         ğŸ‘¤ USER INPUT                                   â”‚ â•‘
â•‘  â”‚           Source: "Tel Aviv"  â†’  Destination: "Jerusalem"              â”‚ â•‘
â•‘  â”‚           Profile: { age: "adult", interests: ["history"] }            â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                 â”‚                                            â•‘
â•‘                                 â–¼                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                      ğŸ—ºï¸ GOOGLE MAPS API                                â”‚ â•‘
â•‘  â”‚              Returns: [Point1, Point2, Point3, Point4]                 â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                 â”‚                                            â•‘
â•‘                                 â–¼                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                       â±ï¸ TIMER/SCHEDULER                               â”‚ â•‘
â•‘  â”‚           Emits points at intervals (streaming mode)                   â”‚ â•‘
â•‘  â”‚           Or processes all at once (instant mode)                      â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                 â”‚                                            â•‘
â•‘  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–¼â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â•‘
â•‘  â•‘                        ğŸ¯ ORCHESTRATOR                                  â•‘ â•‘
â•‘  â•‘              ThreadPoolExecutor (max_workers=12)                        â•‘ â•‘
â•‘  â•‘                                                                         â•‘ â•‘
â•‘  â•‘   FOR EACH POINT:                                                       â•‘ â•‘
â•‘  â•‘   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â•‘ â•‘
â•‘  â•‘   â•‘              PARALLEL AGENT EXECUTION                           â•‘  â•‘ â•‘
â•‘  â•‘   â•‘                                                                 â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚ ğŸ¬ VIDEO    â”‚   â”‚ ğŸµ MUSIC    â”‚   â”‚ ğŸ“– TEXT     â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   AGENT     â”‚   â”‚   AGENT     â”‚   â”‚   AGENT     â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚ â€¢ YouTube   â”‚   â”‚ â€¢ Spotify   â”‚   â”‚ â€¢ Wikipedia â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚ â€¢ Retry: 3x â”‚   â”‚ â€¢ Retry: 3x â”‚   â”‚ â€¢ Retry: 3x â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚ â€¢ Timeout   â”‚   â”‚ â€¢ Timeout   â”‚   â”‚ â€¢ Timeout   â”‚          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â•‘  â•‘ â•‘
â•‘  â•‘   â•‘          â”‚                 â”‚                 â”‚                  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘                            â–¼                                    â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                   ğŸ“¬ SMART QUEUE                        â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                                                         â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   Timeline: [0s]â”€â”€â”€â”€â”€â”€â”€â”€[15s]â”€â”€â”€â”€â”€â”€â”€â”€[30s]             â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚              â”‚           â”‚            â”‚                 â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚              â”‚ Wait for  â”‚ Accept 2   â”‚ Accept 1       â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚              â”‚ 3 agents  â”‚ (graceful) â”‚ (fallback)     â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                                                         â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   Status: [Video âœ…] [Music âœ…] [Text âœ…] â†’ READY!     â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘                             â–¼                                   â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                   âš–ï¸ JUDGE AGENT                        â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                                                         â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   Input: 3 candidates + User Profile                   â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                                                         â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   Scoring (with profile weights):                      â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚     Video: 8.5 Ã— 1.0 (adult) = 8.5                     â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚     Music: 7.0 Ã— 1.0 (adult) = 7.0                     â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚     Text:  9.0 Ã— 1.0 (adult) = 9.0 â­ WINNER          â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚                                                         â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â”‚   DECISION: TEXT (historical content preferred)       â”‚  â•‘  â•‘ â•‘
â•‘  â•‘   â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘  â•‘ â•‘
â•‘  â•‘   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘ â•‘
â•‘  â•‘                                 â”‚                                       â•‘ â•‘
â•‘  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•‘
â•‘                                    â–¼                                         â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                        ğŸ“¦ COLLECTOR                                    â”‚ â•‘
â•‘  â”‚              Aggregates decisions, maintains order                     â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                 â”‚                                            â•‘
â•‘                                 â–¼                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                      ğŸµ FINAL PLAYLIST                                 â”‚ â•‘
â•‘  â”‚                                                                        â”‚ â•‘
â•‘  â”‚  Point 1: Ammunition Hill  â†’ ğŸ“– TEXT: "Battle of Ammunition Hill"    â”‚ â•‘
â•‘  â”‚  Point 2: Old City         â†’ ğŸµ MUSIC: "Jerusalem of Gold"           â”‚ â•‘
â•‘  â”‚  Point 3: Western Wall     â†’ ğŸ¬ VIDEO: "History Documentary"         â”‚ â•‘
â•‘  â”‚  Point 4: Mount of Olives  â†’ ğŸ“– TEXT: "Ancient Burial Ground"        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Plugin & Infrastructure Layer

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          INFRASTRUCTURE LAYER                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                      ğŸ”Œ PLUGIN ARCHITECTURE                             â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â•‘
â•‘  â”‚  â”‚   Weather   â”‚ â”‚    Food     â”‚ â”‚   Events    â”‚ â”‚   Custom    â”‚       â”‚ â•‘
â•‘  â”‚  â”‚   Plugin    â”‚ â”‚   Plugin    â”‚ â”‚   Plugin    â”‚ â”‚   Plugins   â”‚       â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â•‘
â•‘  â”‚         â”‚               â”‚               â”‚               â”‚               â”‚ â•‘
â•‘  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â•‘
â•‘  â”‚                                 â”‚                                        â”‚ â•‘
â•‘  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚ â•‘
â•‘  â”‚                    â”‚    Plugin Registry     â”‚                           â”‚ â•‘
â•‘  â”‚                    â”‚  â€¢ Auto-discovery      â”‚                           â”‚ â•‘
â•‘  â”‚                    â”‚  â€¢ Lifecycle mgmt      â”‚                           â”‚ â•‘
â•‘  â”‚                    â”‚  â€¢ Dependency resolve  â”‚                           â”‚ â•‘
â•‘  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚   ğŸ›¡ï¸ RESILIENCE      â”‚ â”‚   ğŸ“Š OBSERVABILITY   â”‚ â”‚   ğŸ’‰ DEPENDENCY     â”‚ â•‘
â•‘  â”‚                      â”‚ â”‚                      â”‚ â”‚      INJECTION      â”‚ â•‘
â•‘  â”‚ â€¢ Circuit Breaker   â”‚ â”‚ â€¢ Metrics (Counter,  â”‚ â”‚                      â”‚ â•‘
â•‘  â”‚ â€¢ Retry + Backoff   â”‚ â”‚   Gauge, Histogram)  â”‚ â”‚ â€¢ IoC Container     â”‚ â•‘
â•‘  â”‚ â€¢ Timeout           â”‚ â”‚ â€¢ Distributed Trace  â”‚ â”‚ â€¢ Lifetime mgmt     â”‚ â•‘
â•‘  â”‚ â€¢ Rate Limiter      â”‚ â”‚ â€¢ Health Checks      â”‚ â”‚ â€¢ Auto-wiring       â”‚ â•‘
â•‘  â”‚ â€¢ Bulkhead          â”‚ â”‚ â€¢ Structured Logs    â”‚ â”‚ â€¢ Scoped deps       â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚                        ğŸ£ EVENT BUS & HOOKS                             â”‚ â•‘
â•‘  â”‚                                                                         â”‚ â•‘
â•‘  â”‚   Events:  AgentStarted â†’ AgentCompleted â†’ JudgeDecision â†’ RouteCompleteâ”‚ â•‘
â•‘  â”‚   Hooks:   @before_hook â†’ @around_hook â†’ @after_hook â†’ @error_hook     â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Data Flow Sequence

```
                                    TIME â†’
    
    User Input â”€â”€â”€â”€â”€â”€â”
                     â”‚
                     â–¼
    Google Maps â”€â”€â”€â”€â”€â”¤ Returns 4 route points
                     â”‚
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ POINT 1        â”‚                                                    â”‚
    â”‚                â–¼                                                    â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚ Video â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (slower - YouTube API)          â”‚  â”‚
    â”‚   â”‚                    â”‚ submit()                                â”‚  â”‚
    â”‚   â”‚ Music â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (faster)                       â”‚  â”‚
    â”‚   â”‚                â”‚ submit()                                    â”‚  â”‚
    â”‚   â”‚ Text â”€â”€â”€â”€â”€â”€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ (medium)                       â”‚  â”‚
    â”‚   â”‚                  â”‚ submit()                                  â”‚  â”‚
    â”‚   â”‚                  â–¼                                           â”‚  â”‚
    â”‚   â”‚ Queue â”€â”€â”€â”€â”€[1/3]â”€â”€[2/3]â”€â”€[3/3 READY!]                       â”‚  â”‚
    â”‚   â”‚                          â”‚                                   â”‚  â”‚
    â”‚   â”‚                          â–¼                                   â”‚  â”‚
    â”‚   â”‚ Judge â”€â”€â”€â”€â”€â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆ (evaluates all 3)               â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                              â”‚                                      â”‚
    â”‚                              â–¼                                      â”‚
    â”‚   Decision: "TEXT - The Silent Monks of Latrun"                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    (Repeat for Points 2, 3, 4 - can run in parallel!)
                     â”‚
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     FINAL PLAYLIST OUTPUT                          â”‚
    â”‚  Point 1: ğŸ“– TEXT - "The Silent Monks of Latrun"                  â”‚
    â”‚  Point 2: ğŸ¬ VIDEO - "Battle of Ammunition Hill"                  â”‚
    â”‚  Point 3: ğŸµ MUSIC - "Jerusalem of Gold"                          â”‚
    â”‚  Point 4: ğŸ“– TEXT - "Old City History"                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¬ Live Execution Timeline

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           PIPELINE EXECUTION TIMELINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TIME(s)  0        5        10       15       20       25       30
         â”‚        â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
         â–¼        â–¼        â–¼        â–¼        â–¼        â–¼        â–¼
         
POINT 1: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         â”‚
         â”œâ”€ğŸ¬ Video â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Done (8s)
         â”‚                    â†“ submit()
         â”œâ”€ğŸµ Music â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Done (3s)  
         â”‚          â†“ submit()
         â”œâ”€ğŸ“– Text  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Done (5s)
         â”‚              â†“ submit()
         â”‚
         â”œâ”€ğŸ“¬ Queue [1/3]â”€â”€[2/3]â”€â”€[3/3 READY!]
         â”‚                         â†“
         â””â”€âš–ï¸ Judge â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Evaluates (12-15s)
                                       â†“
                               ğŸ† WINNER: TEXT
                               
POINT 2: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• (Starts in parallel!)
         â”‚
         â”œâ”€ğŸ¬ Video â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 
         â”œâ”€ğŸµ Music â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 
         â”œâ”€ğŸ“– Text  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 
         â”‚
         â””â”€ğŸ“¬ Queue â†’ âš–ï¸ Judge â†’ ğŸ† WINNER: VIDEO

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LEGEND:  â–ˆâ–ˆâ–ˆâ–ˆ = Processing    â–‘â–‘â–‘â–‘ = Waiting    â†“ = Submit to Queue
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ğŸ§© Component Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              COMPONENT MAP                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ“ src/                                                             â”‚   â”‚
â”‚   â”‚  â”‚                                                                   â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ ğŸ¤– agents/           â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ base_agent.py    "All agents inherit from BaseAgent"   â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ video_agent.py   â”€â”€â†’ YouTube API                       â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ music_agent.py   â”€â”€â†’ Spotify API                       â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ text_agent.py    â”€â”€â†’ Web Search                        â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â””â”€â”€ judge_agent.py   â”€â”€â†’ LLM (GPT/Claude)                  â”‚   â”‚   â”‚
â”‚   â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ âš™ï¸ core/                                                    â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ orchestrator.py  "Manages parallel execution"          â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ smart_queue.py   "Sync point: Wait 3, Fallback 2â†’1"    â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ collector.py     "Aggregates final results"            â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚                                                           â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ ğŸ”Œ plugins/      "Extensibility layer"                 â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ registry.py  â”€â”€â†’ Auto-discovers plugins            â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ hooks.py     â”€â”€â†’ @before, @after, @around          â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â””â”€â”€ events.py    â”€â”€â†’ Pub/Sub event bus                 â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚                                                           â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ ğŸ›¡ï¸ resilience/   "Fault tolerance"                     â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ circuit_breaker.py                                  â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ retry.py     â”€â”€â†’ Exponential backoff               â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â””â”€â”€ timeout.py   â”€â”€â†’ 30s default                       â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚                                                           â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ ğŸ“Š observability/                                       â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ metrics.py   â”€â”€â†’ Counter, Gauge, Histogram         â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ tracing.py   â”€â”€â†’ Distributed tracing               â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚   â””â”€â”€ health.py    â”€â”€â†’ /health, /ready endpoints         â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”‚                                                           â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â””â”€â”€ ğŸ’‰ di/           "Dependency Injection"                â”‚   â”‚   â”‚
â”‚   â”‚  â”‚       â””â”€â”€ container.py â”€â”€â†’ IoC container                     â”‚   â”‚   â”‚
â”‚   â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ ğŸ“¦ models/           "Pydantic data models"                â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ route.py         Route, RoutePoint                     â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ content.py       ContentResult, ContentType            â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ decision.py      JudgeDecision                         â”‚   â”‚   â”‚
â”‚   â”‚  â”‚   â””â”€â”€ user_profile.py  UserProfile, preferences              â”‚   â”‚   â”‚
â”‚   â”‚  â”‚                                                               â”‚   â”‚   â”‚
â”‚   â”‚  â””â”€â”€ ğŸŒ services/         "External API clients"                â”‚   â”‚   â”‚
â”‚   â”‚      â””â”€â”€ google_maps.py   â”€â”€â†’ Google Maps Directions            â”‚   â”‚   â”‚
â”‚   â”‚                                                                  â”‚   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  ğŸ“ plugins/              "Drop-in agent extensions"             â”‚   â”‚
â”‚   â”‚  â”‚                                                                   â”‚   â”‚
â”‚   â”‚  â”œâ”€â”€ weather/             WeatherAgent (OpenWeatherMap)          â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ plugin.yaml      Manifest: name, version, config       â”‚   â”‚
â”‚   â”‚  â”‚   â”œâ”€â”€ plugin.py        Plugin lifecycle class                 â”‚   â”‚
â”‚   â”‚  â”‚   â””â”€â”€ agent.py         Actual agent implementation            â”‚   â”‚
â”‚   â”‚  â”‚                                                                   â”‚   â”‚
â”‚   â”‚  â””â”€â”€ food/                FoodAgent (coming soon)                â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â”‚  User Input  â”‚â”€â”€â”€â”€â–¶â”‚ Google Maps  â”‚â”€â”€â”€â”€â–¶â”‚  Route       â”‚
â”‚              â”‚     â”‚    API       â”‚     â”‚  (4 points)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                            â–¼                            â”‚
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                     â”‚  â”‚              FOR EACH POINT                      â”‚   â”‚
                     â”‚  â”‚                                                  â”‚   â”‚
                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
                     â”‚  â”‚  â”‚ Video   â”‚  â”‚  Music  â”‚  â”‚  Text   â”‚  â—€â”€â”€ Parallel
                     â”‚  â”‚  â”‚ Agent   â”‚  â”‚  Agent  â”‚  â”‚  Agent  â”‚          â”‚   â”‚
                     â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â”‚   â”‚
                     â”‚  â”‚       â”‚            â”‚            â”‚                â”‚   â”‚
                     â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
                     â”‚  â”‚                    â–¼                             â”‚   â”‚
                     â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
                     â”‚  â”‚           â”‚  Smart Queue   â”‚  â—€â”€â”€ Sync Point     â”‚   â”‚
                     â”‚  â”‚           â”‚  (wait for 3)  â”‚                     â”‚   â”‚
                     â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
                     â”‚  â”‚                   â–¼                              â”‚   â”‚
                     â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
                     â”‚  â”‚           â”‚  Judge Agent   â”‚  â—€â”€â”€ Evaluates all  â”‚   â”‚
                     â”‚  â”‚           â”‚  + User Profileâ”‚                     â”‚   â”‚
                     â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
                     â”‚  â”‚                   â”‚                              â”‚   â”‚
                     â”‚  â”‚                   â–¼                              â”‚   â”‚
                     â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
                     â”‚  â”‚           â”‚   Decision     â”‚  â—€â”€â”€ Winner chosen  â”‚   â”‚
                     â”‚  â”‚           â”‚   (1 of 3)     â”‚                     â”‚   â”‚
                     â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
                     â”‚  â”‚                                                  â”‚   â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                     â”‚                            â”‚                            â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                      COLLECTOR                          â”‚
                     â”‚                                                         â”‚
                     â”‚  Point 1: TEXT  - "Historical facts..."                â”‚
                     â”‚  Point 2: VIDEO - "Documentary..."                     â”‚
                     â”‚  Point 3: MUSIC - "Jerusalem of Gold"                  â”‚
                     â”‚  Point 4: TEXT  - "Ancient stories..."                 â”‚
                     â”‚                                                         â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                   FINAL PLAYLIST                        â”‚
                     â”‚                    (JSON Output)                        â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Installation

### Prerequisites

- Python 3.10+ 
- [UV](https://docs.astral.sh/uv/) - Ultra-fast Python package manager

### Step 1: Install UV

```bash
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# Or with Homebrew
brew install uv
```

### Step 2: Clone & Setup

```bash
# Clone repository
git clone <your-repo-url>
cd Assignment4-multi-agent-tour-guide-parallel

# Full setup (creates venv + installs all dependencies)
make setup

# Or step by step:
uv venv              # Create virtual environment
uv sync              # Install production dependencies
uv sync --extra dev  # Include dev tools
```

### Step 3: Configure API Keys

Create a `.env` file in the project root:

```bash
cp env.example .env
# Then edit .env with your API keys
```

#### ğŸ”‘ Required vs Optional API Keys

| API Key | Required? | Purpose | Get It From |
|---------|-----------|---------|-------------|
| `ANTHROPIC_API_KEY` | âœ… **Preferred*** | Powers all AI agents with Claude | [Anthropic Console](https://console.anthropic.com/) |
| `OPENAI_API_KEY` | â­• Alternative | Use GPT instead of Claude | [OpenAI Platform](https://platform.openai.com/api-keys) |
| `GOOGLE_MAPS_API_KEY` | â­• Optional | Real route generation | [Google Cloud Console](https://console.cloud.google.com/) |
| `YOUTUBE_API_KEY` | â­• Optional | Real YouTube video search | [Google Cloud Console](https://console.cloud.google.com/) |
| `SPOTIFY_CLIENT_ID` | â­• Optional | Real Spotify music search | [Spotify Developer](https://developer.spotify.com/) |
| `SPOTIFY_CLIENT_SECRET` | â­• Optional | Real Spotify music search | [Spotify Developer](https://developer.spotify.com/) |
| `OPENWEATHERMAP_API_KEY` | â­• Optional | Weather plugin | [OpenWeatherMap](https://openweathermap.org/api) |

> **\*** Without any LLM key, agents use mock responses (demo mode still works!)

#### ğŸ“ Complete `.env` Example

```bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# MULTI-AGENT TOUR GUIDE - ENVIRONMENT CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ¤– LLM PROVIDER (Required - choose ONE)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Option 1: Anthropic Claude (PREFERRED) â­
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Option 2: OpenAI GPT (Alternative)
# OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ—ºï¸ GOOGLE MAPS (Optional - for real routes)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Without this, uses mock route: Tel Aviv â†’ Jerusalem
# GOOGLE_MAPS_API_KEY=AIzaxxxxxxxxxxxxxxxxxxxxxxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ¬ YOUTUBE DATA API (Optional - for real video search)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Without this, Video Agent uses LLM-based recommendations
# YOUTUBE_API_KEY=AIzaxxxxxxxxxxxxxxxxxxxxxxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸµ SPOTIFY (Optional - for real music search)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Without this, Music Agent uses LLM-based recommendations
# SPOTIFY_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# SPOTIFY_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŒ¤ï¸ WEATHER PLUGIN (Optional)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPENWEATHERMAP_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âš™ï¸ SYSTEM CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LOG_LEVEL=INFO                    # DEBUG, INFO, WARNING, ERROR
LLM_MODEL=claude-sonnet-4        # or gpt-4o-mini
LLM_TEMPERATURE=0.7              # Creativity level (0.0-1.0)
AGENT_TIMEOUT_SECONDS=30         # Max time per agent
```

#### ğŸš€ Minimum Setup (Just LLM)

For the **simplest working setup**, you only need ONE key:

```bash
# .env (minimum) - Using Claude (Preferred)
ANTHROPIC_API_KEY=sk-ant-your-key-here

# OR using OpenAI
# OPENAI_API_KEY=sk-proj-your-key-here
```

Then run:
```bash
python main.py --demo --mode queue
```

### Verify Installation

```bash
# Check everything is working
make check

# Or run a quick test
uv run python main.py --demo --mode queue
```

---

## ğŸ“ Project Structure

```
multi-agent-tour-guide/
â”œâ”€â”€ main.py                    # ğŸš€ Entry point (thin wrapper)
â”œâ”€â”€ pyproject.toml             # Project config & dependencies
â”œâ”€â”€ Makefile                   # Build automation
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ src/                       # ğŸ“¦ SOURCE CODE (Production)
â”‚   â”œâ”€â”€ agents/                # AI Agents
â”‚   â”‚   â”œâ”€â”€ base_agent.py      #   Base class for all agents
â”‚   â”‚   â”œâ”€â”€ base_agent_v2.py   #   Enhanced with hooks & resilience
â”‚   â”‚   â”œâ”€â”€ video_agent.py     #   YouTube content finder
â”‚   â”‚   â”œâ”€â”€ music_agent.py     #   Spotify/music finder
â”‚   â”‚   â”œâ”€â”€ text_agent.py      #   Historical/story finder
â”‚   â”‚   â”œâ”€â”€ judge_agent.py     #   Content evaluator
â”‚   â”‚   â””â”€â”€ configs/           #   YAML agent configurations
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                  # Core Infrastructure
â”‚   â”‚   â”œâ”€â”€ orchestrator.py    #   Agent coordination
â”‚   â”‚   â”œâ”€â”€ smart_queue.py     #   Queue synchronization
â”‚   â”‚   â”œâ”€â”€ collector.py       #   Result aggregation
â”‚   â”‚   â”œâ”€â”€ timer_scheduler.py #   Travel simulation
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ plugins/           #   ğŸ”Œ Plugin Architecture
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py        #      Base plugin class
â”‚   â”‚   â”‚   â”œâ”€â”€ registry.py    #      Auto-discovery & lifecycle
â”‚   â”‚   â”‚   â”œâ”€â”€ events.py      #      Event bus (pub/sub)
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks.py       #      AOP-style hooks
â”‚   â”‚   â”‚   â””â”€â”€ manager.py     #      Plugin lifecycle manager
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ resilience/        #   ğŸ›¡ï¸ Fault Tolerance
â”‚   â”‚   â”‚   â”œâ”€â”€ circuit_breaker.py
â”‚   â”‚   â”‚   â”œâ”€â”€ retry.py       #      Exponential backoff
â”‚   â”‚   â”‚   â”œâ”€â”€ timeout.py
â”‚   â”‚   â”‚   â”œâ”€â”€ rate_limiter.py
â”‚   â”‚   â”‚   â”œâ”€â”€ bulkhead.py
â”‚   â”‚   â”‚   â””â”€â”€ fallback.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ observability/     #   ğŸ“Š Monitoring
â”‚   â”‚   â”‚   â”œâ”€â”€ metrics.py     #      Counter, Gauge, Histogram
â”‚   â”‚   â”‚   â”œâ”€â”€ tracing.py     #      Distributed tracing
â”‚   â”‚   â”‚   â””â”€â”€ health.py      #      Liveness/readiness probes
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ di/                #   ğŸ’‰ Dependency Injection
â”‚   â”‚       â”œâ”€â”€ container.py   #      IoC container
â”‚   â”‚       â”œâ”€â”€ scope.py       #      Lifetime management
â”‚   â”‚       â””â”€â”€ providers.py   #      Factory/lazy/pooled
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                # Data Models (Pydantic)
â”‚   â”‚   â”œâ”€â”€ content.py         #   ContentResult
â”‚   â”‚   â”œâ”€â”€ route.py           #   Route, RoutePoint
â”‚   â”‚   â”œâ”€â”€ decision.py        #   JudgeDecision
â”‚   â”‚   â”œâ”€â”€ user_profile.py    #   UserProfile
â”‚   â”‚   â””â”€â”€ output.py          #   TourGuideOutput
â”‚   â”‚
â”‚   â”œâ”€â”€ services/              # External Services
â”‚   â”‚   â””â”€â”€ google_maps.py     #   Maps API client
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                   # Command Line Interface
â”‚   â”‚   â””â”€â”€ main.py            #   CLI commands
â”‚   â”‚
â”‚   â””â”€â”€ utils/                 # Utilities
â”‚       â”œâ”€â”€ config.py          #   Configuration loading
â”‚       â”œâ”€â”€ logger.py          #   Structured logging
â”‚       â””â”€â”€ retry.py           #   Retry utilities
â”‚
â”œâ”€â”€ plugins/                   # ğŸ”Œ PLUGIN DIRECTORY
â”‚   â”œâ”€â”€ weather/               #   Example: Weather plugin
â”‚   â”‚   â”œâ”€â”€ plugin.yaml        #      Plugin manifest
â”‚   â”‚   â”œâ”€â”€ plugin.py          #      Plugin class
â”‚   â”‚   â””â”€â”€ agent.py           #      WeatherAgent
â”‚   â””â”€â”€ food/                  #   Placeholder for food plugin
â”‚
â”œâ”€â”€ config/                    # Configuration Files
â”‚   â””â”€â”€ default.yaml           #   Default settings
â”‚
â”œâ”€â”€ tests/                     # Test Suite
â”‚   â”œâ”€â”€ unit/                  #   Unit tests
â”‚   â”œâ”€â”€ integration/           #   Integration tests
â”‚   â””â”€â”€ e2e/                   #   End-to-end tests
â”‚
â”œâ”€â”€ docs/                      # Documentation
â”‚   â”œâ”€â”€ ARCHITECTURE.md        #   System design
â”‚   â”œâ”€â”€ MIT_PRODUCTION_ARCHITECTURE.md
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ data/                      # Runtime Data
    â”œâ”€â”€ cache/                 #   API response cache
    â”œâ”€â”€ logs/                  #   Log files
    â””â”€â”€ samples/               #   Sample data
```

**Key Design Decisions:**
- âœ… **Single `main.py` entry point** - thin wrapper that calls `src/cli/main.py`
- âœ… **All logic in `src/`** - clean separation of concerns
- âœ… **Plugin directory at root** - easy to add/remove plugins
- âœ… **Configuration-driven** - YAML configs for agents and settings

---

## ğŸ® Usage

### Basic Commands

```bash
# Demo mode (uses mock APIs, no keys needed)
uv run python main.py --demo

# Queue mode (recommended - shows synchronization)
uv run python main.py --demo --mode queue

# Interactive mode (prompts for input)
uv run python main.py --interactive

# Custom route
uv run python main.py --origin "Paris, France" --destination "Lyon, France"

# With user profile
uv run python main.py --demo --profile family --min-age 5
uv run python main.py --demo --profile history
```

### All Running Modes

| Mode | Command | Description |
|------|---------|-------------|
| **Queue** | `--mode queue` | â­ Recommended. Shows queue synchronization between agents |
| **Streaming** | `--mode streaming` | Real-time simulation, points arrive at intervals |
| **Instant** | `--mode instant` | Process all points in parallel immediately |
| **Sequential** | `--mode sequential` | Process one point at a time (debugging) |

### Makefile Commands

```bash
# === Running ===
make run              # Run demo mode
make run-queue        # Run with queue synchronization
make run-streaming    # Run streaming simulation
make run-api          # Start REST API server

# === Development ===
make test             # Run all tests
make test-cov         # Tests with coverage report
make lint             # Check code quality
make format           # Auto-format code

# === Package Management ===
make sync             # Install production deps
make dev              # Install dev deps
make all              # Install all deps
make add PKG=name     # Add a package
make upgrade          # Upgrade all packages

# === Cleanup ===
make clean            # Remove cache files
make clean-all        # Remove cache + venv
```

---

## ğŸ“¡ Monitoring Traffic on All Hops

### Enable Verbose Logging

```bash
# Set log level to DEBUG to see all traffic
export LOG_LEVEL=DEBUG

# Run with full visibility
uv run python main.py --demo --mode queue 2>&1 | tee tour_log.txt
```

### Expected Output (Traffic on All Hops)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ—ºï¸  MULTI-AGENT TOUR GUIDE SYSTEM  ğŸ—ºï¸                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ­ Running DEMO MODE with sample route...

ğŸ“¬ Queue-based processing: Tel Aviv, Israel â†’ Jerusalem, Israel
   Total points: 4
   Profile: default

ğŸ”„ Using QUEUE synchronization between agents and judge...

==================================================
ğŸ“ [1/4] Latrun
==================================================

[2024-11-29 10:15:32] ğŸ¬ VideoAgent    | Starting search for "Latrun"
[2024-11-29 10:15:32] ğŸµ MusicAgent    | Starting search for "Latrun"
[2024-11-29 10:15:32] ğŸ“– TextAgent     | Starting search for "Latrun"
[2024-11-29 10:15:33] ğŸµ MusicAgent    | âœ… Submitted to queue (1/3)
[2024-11-29 10:15:33] ğŸ“– TextAgent     | âœ… Submitted to queue (2/3)
[2024-11-29 10:15:34] ğŸ¬ VideoAgent    | âœ… Submitted to queue (3/3)
[2024-11-29 10:15:34] ğŸ“¬ Queue         | âœ… All 3 agents ready!
[2024-11-29 10:15:34] âš–ï¸ JudgeAgent    | Evaluating 3 candidates...
[2024-11-29 10:15:35] âš–ï¸ JudgeAgent    | Decision: TEXT
[2024-11-29 10:15:35] âš–ï¸ JudgeAgent    | Reasoning: Historical monastery content...

   ğŸ† Winner: TEXT
      Title: The Silent Monks of Latrun
      Reason: Unique story about the monastery - more memorable than generic video

==================================================
ğŸ“ [2/4] Ammunition Hill
==================================================

[2024-11-29 10:15:35] ğŸ¬ VideoAgent    | Starting search for "Ammunition Hill"
[2024-11-29 10:15:35] ğŸµ MusicAgent    | Starting search for "Ammunition Hill"
[2024-11-29 10:15:35] ğŸ“– TextAgent     | Starting search for "Ammunition Hill"
...

============================================================
ğŸ—ºï¸  TOUR GUIDE PLAYLIST
============================================================
Route: Tel Aviv, Israel â†’ Jerusalem, Israel
Total Points: 4
------------------------------------------------------------

ğŸ“ Point 1: Latrun
   (Latrun Monastery)
   ğŸ“– TEXT: The Silent Monks of Latrun
   ğŸ”— https://en.wikipedia.org/wiki/Latrun
   ğŸ’­ Unique story about the monastery - more memorable

ğŸ“ Point 2: Ammunition Hill
   (Ammunition Hill Memorial)
   ğŸ¬ VIDEO: Battle of Ammunition Hill Documentary
   ğŸ”— https://youtube.com/watch?v=...
   ğŸ’­ Historical significance demands visual content

ğŸ“ Point 3: Old City Jerusalem
   (Old City)
   ğŸµ MUSIC: Jerusalem of Gold
   ğŸ”— https://open.spotify.com/track/...
   ğŸ’­ Iconic arrival song - emotional impact

ğŸ“ Point 4: Mount of Olives
   (Mount of Olives)
   ğŸ“– TEXT: Ancient Burial Ground History
   ğŸ”— https://en.wikipedia.org/wiki/Mount_of_Olives
   ğŸ’­ Rich historical content about the location

============================================================

ğŸ“Š Processing Statistics:
   total_points: 4
   successful_decisions: 4
   average_processing_time: 2.34s
   queue_timeouts: 0
   agents_failed: 0

âœ¨ Tour guide generation complete!
```

### Monitor Specific Components

```bash
# Monitor only Queue operations
uv run python main.py --demo --mode queue 2>&1 | grep -E "(Queue|ğŸ“¬)"

# Monitor only Agent activity
uv run python main.py --demo --mode queue 2>&1 | grep -E "(Agent|ğŸ¬|ğŸµ|ğŸ“–)"

# Monitor only Judge decisions
uv run python main.py --demo --mode queue 2>&1 | grep -E "(Judge|âš–ï¸|Winner|ğŸ†)"

# Monitor timing
uv run python main.py --demo --mode queue 2>&1 | grep -E "(took|seconds|duration)"
```

### Real-time Metrics

```python
# In your code, access metrics:
from src.core.observability import MetricsRegistry

# Get all metrics
metrics = MetricsRegistry.collect_all()
print(metrics)

# Export in Prometheus format
print(MetricsRegistry.to_prometheus())
```

### Health Check Endpoint

```bash
# Start API server
make run-api

# Check health
curl http://localhost:8000/health

# Response:
{
    "status": "healthy",
    "checks": {
        "video_agent": {"status": "healthy", "latency_ms": 12},
        "music_agent": {"status": "healthy", "latency_ms": 8},
        "text_agent": {"status": "healthy", "latency_ms": 15},
        "judge_agent": {"status": "healthy", "latency_ms": 5}
    }
}
```

### Distributed Tracing

```python
# Access trace data
from src.core.observability import get_tracer

tracer = get_tracer("tour-guide")
spans = tracer.get_spans(limit=100)

for span in spans:
    print(f"{span.name}: {span.duration_ms}ms")
```

---

## ğŸ”Œ Plugin System

### Adding a New Agent (5 Minutes)

1. **Create plugin directory:**

```bash
mkdir -p plugins/food
```

2. **Create plugin manifest (`plugins/food/plugin.yaml`):**

```yaml
name: food
version: 1.0.0
description: Restaurant recommendations for route points
capabilities:
  - CONTENT_PROVIDER
enabled: true
```

3. **Implement plugin (`plugins/food/plugin.py`):**

```python
from src.core.plugins.base import BasePlugin
from src.core.plugins.registry import PluginRegistry

@PluginRegistry.register("food")
class FoodPlugin(BasePlugin):
    def _on_start(self):
        self.api = RestaurantAPI(self.config.api_key)
    
    def _on_stop(self):
        self.api.close()
    
    def find_restaurants(self, location: str):
        return self.api.search(location, limit=5)
```

4. **That's it!** The plugin is auto-discovered on startup.

### Available Plugins

| Plugin | Status | Description |
|--------|--------|-------------|
| `weather` | âœ… Included | Weather information for points |
| `food` | ğŸ”§ Template | Restaurant recommendations |
| `events` | ğŸ“‹ Planned | Local events and activities |
| `safety` | ğŸ“‹ Planned | Safety alerts and warnings |

---

## âš™ï¸ Configuration

### Default Configuration (`config/default.yaml`)

```yaml
# Agent settings
agents:
  timeout_seconds: 30
  max_retries: 3
  parallel_workers: 3

# Queue settings
queue:
  expected_agents: 3
  soft_timeout_seconds: 15
  hard_timeout_seconds: 30
  min_required_agents: 1

# LLM settings
llm:
  provider: openai  # or anthropic
  model: gpt-4o-mini
  temperature: 0.7
  max_tokens: 1024

# Logging
logging:
  level: INFO
  format: structured
  include_thread_name: true
```

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `OPENAI_API_KEY` | OpenAI API key | Required |
| `LOG_LEVEL` | Logging level | `INFO` |
| `MAX_CONCURRENT_THREADS` | Max thread pool size | `12` |
| `AGENT_TIMEOUT_SECONDS` | Agent execution timeout | `30` |
| `QUEUE_SOFT_TIMEOUT` | Wait time before accepting 2/3 | `15` |
| `QUEUE_HARD_TIMEOUT` | Wait time before accepting 1/3 | `30` |

---

## ğŸ§ª Testing

```bash
# Run all tests
make test

# Run with coverage
make test-cov

# Run specific test file
uv run pytest tests/unit/test_queue.py -v

# Run integration tests
uv run pytest tests/integration/ -v

# Run e2e tests
uv run pytest tests/e2e/ -v
```

### Test Coverage Report

```bash
make test-cov
# Opens HTML report in browser
open htmlcov/index.html
```

---

## ğŸ“š Documentation

| Document | Description |
|----------|-------------|
| [MIT_PRODUCTION_ARCHITECTURE.md](docs/MIT_PRODUCTION_ARCHITECTURE.md) | Full architecture documentation |
| [ARCHITECTURE.md](docs/ARCHITECTURE.md) | System design and data flow |
| [STARTUP_DESIGN.md](docs/STARTUP_DESIGN.md) | Production deployment design |
| [DEVELOPMENT_PROMPTS.md](docs/DEVELOPMENT_PROMPTS.md) | Prompts for building components |

---

## ğŸ“ Academic References

1. **Martin, R.C.** (2017). *Clean Architecture*. Prentice Hall.
2. **Gamma et al.** (1994). *Design Patterns*. Addison-Wesley.
3. **Nygard, M.T.** (2018). *Release It!* Pragmatic Bookshelf.
4. **Fowler, M.** (2002). *Patterns of Enterprise Application Architecture*. Addison-Wesley.

---

## ğŸ“„ License

MIT License - See [LICENSE](LICENSE) file.

---

<div align="center">

**Built with â¤ï¸ using production-grade architecture patterns**

*Parallel agents â€¢ Plugin architecture â€¢ Production-grade resilience*

</div>
